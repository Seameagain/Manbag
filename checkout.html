<h2>ตะกร้าของคุณ</h2>
<div id="items"></div>
<button onclick="pay()">ชำระเงิน</button>

<script>
const cart = JSON.parse(localStorage.getItem("cart"));
document.getElementById("items").innerHTML =
 cart.map(i=>`<p>${i.title} - ${i.price} บาท</p>`).join("");

function pay(){
 const { data: { user } } = await supabase.auth.getUser();

function pay(){
 fetch("/api/create-checkout",{
  method:"POST",
  headers:{ "Content-Type":"application/json" },
  body: JSON.stringify({
    cart: cart,
    userId: user.id
  })
 })
 .then(r=>r.json())
 .then(d=>location.href=d.url);
}
 .then(r=>r.json())
 .then(d=>location.href=d.url);
}
</script>
